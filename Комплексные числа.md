---
permalink: /complex
title: Комплексные числа
layout: post
---
# Содержание
* TOC
{:toc}
# Введение
Комплексные числа — штука странная. Многие не понимают — зачем математики их придумали и теперь морочат людям головы. На самом деле они применяются во многих областях физики, таких как электромагнетизм и квантовая механика. В следующих главах будет описано что именно они из себя представляют, как учёные додумались до их открытия и что такое "Комплексный анализ". Предупреждение: для прочтения главы "Формулы" понадобятся знания алгебры и базовые знания математического анализа и тригонометрии.

# История открытия

## Квадратные уравнения

Все мы хорошо знаем формулу для решений квадратного уравнения:

$$x_{1,2}=\frac{-b\pm\sqrt{b^2-4ac}}{2a}$$

Обычно люди подставляют числа в формулу, не задумываясь о том, что математики в древности вывели эту формулу используя **геометрию**. 

### Геометрическое решение

В те времена, привычных нам формул не было, математические выражения записывались с помощью слов и рисунков. Рассмотрим уравнение $x^2+26x=27$. Для древних математиков $x^2$ это реальный квадрат со стороной в $x$, а $26x$ это прямоугольник у которого одна сторона $x$, а другая — 26. Сумма их площадей соответственно равна 27. Как же нам тогда найти $x$? Возьмём прямоугольник $26x$ и разрежем его пополам. Тогда получатся два прямоугольника по $13x$. Расположим фигуры так, чтобы получился незаконченный квадрат. До полного квадрата ему не хватает фигуры, размеры которой мы точно знаем, сторона его равна 13, а площадь соответственно $13^2$ то есть 169. Раз уж мы прибавили 169 к левой части, нужно добавить столько же и к правой, чтобы стороны уравнения остались равны: $x^2+26x+169=27+169$. Итак, мы получили большой квадрат со стороной $x+13$ и площадью $27+169$ то есть $196$. Осталось всего ничего — извлекаем квадратный корень из 196 — это 14, соответственно $x+13=14$, и $x$ равен $1$. Это прекрасный наглядный способ показать квадратное уравнение, но есть одна проблема. **Это решение неполное.**

### Проблема

Дело в том, что уравнение $x^2+26x=27$ имеет ещё одно решение, а именно $-27$. Тысячелетиями математики не подозревали о существовании отрицательных решений для подобных уравнений, ведь они привыкли работать с реальным миром — длиной, площадью, объемом. Как можно представить себе квадрат со стороной $-27$? Это же бессмыслица какая-то! В математике того времени отрицательных чисел просто не существовало. Учёным они настолько не нравились, что даже не было общей формы квадратного уравнения, которую мы знаем. Они составили шесть вариантов, чтобы все коэффициенты оставались положительными:
- $ax^2=bx$
- $ax^2=c$
- $ax=c$
- $ax^2+bx=c$
- $ax^2+c=bx$
- $bx+c=ax^2$

Тоже касалось и **кубических уравнений**

## Кубические уравнения

### Омар Хайям

В Ⅺ веке персидский математик Омар Хайям сформулировал 18 различных кубических уравнений, так, чтобы все коэффициенты оставались положительными:
- $x^3=c$
- $x^3=bx$
- $x^3=ax^2$
- $x^3+ax^2=bx$
- $x^3=ax^2+bx$
- $x^3+bx=ax^2$
- $x^3+bx=c$
- $x^3+c=bx$
- $x^3+ax^2=c$
- $x^3+c=ax^2$
- $x^3=ax^2+c$
- $x^3=bx+c$
- $x^3+ax^2=bx+c$
- $x^3+c=ax^2+bx$
- $x^3+ax^2+c=bx$
- $x^3+ax^2+bx=c$
- $x^3+bx=ax^2+c$
- $x^3+bx+c=ax^2$

<img src='https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRmrBoiYNxKq4vatqduOHfuOkwR5I90EcexuQ&s' width='133px'/>

Решение некоторых из них он нашёл с помощью пересечений разных фигур вроде гипербол и кругов. Но найти решение для общего случая кубического уравнения ему не удалось. Он писал:

> „Быть может кто-то из наших потомков сможет его найти.“ 

Надежда появилась лишь 400 лет спустя в четырёх тысячах километров в Италии.

### Сципион Дель Ферро

Сципион Дель Ферро преподавал математику в университете. Примерно в 1510 году он нашёл решение так называемого приведённого кубического уравнения, где слагаемого $bx^2$ нет. Но он спрятал это решение. Зачем? Дело в том, что в то время математики бросали друг другу вызовы — обменивались задачами. Кто больше задач решил, тот получает приз, а проигравший — публичное унижение. Всю жизнь Ферро никому не разглашал своё решение и только перед самой смертью раскрыл своему ученику формулу. А звали его Антонио Фиори.

### Антонио Фиори и Тарталья

Фиори не имел большого математического таланта. Он любил хвастаться, что умеет решать кубические уравнения. Вскоре, в 1535 году ему бросает вызов математик Никколо Тарталья. Никколо привык к трудностям. В детстве французский солдат ударил его по лицу саблей, из-за чего тот стал заикаться и получил прозвище "Тарталья", что на итальянском значит "Заика". Он учился сам по книгам, пока наконец не стал уважаемым математиком. Тарталья передал Фиори 30 задач, а в ответ получил 30 примеров, полностью основных на приведённых кубических уравнениях. За отведённые 30 дней Фиори не справился не с одной задачей, а вот Тарталья решил все примеры, причём всего за 2 часа. Чтобы Тарталья смог понять откуда Фиори знает как решать кубические уравнения ему пришлось вывести решение самому.

### Решение Тартальи

<img src= 'https://upload.wikimedia.org/wikipedia/commons/thumb/1/1d/Portret_van_Niccolo_Tartaglia_Nicolavs_Tartaglia_Brixianvs_%28titel_op_object%29_Portretten_van_beroemde_Europese_geleerden_%28serietitel%29_Virorum_doctorum_de_Disciplinis_benemerentium_effigies_%28serietitel%29%2C_RP-P-1909-4459.jpg/597px-thumbnail.jpg?20191119185110' width='133px'/>

Возьмём уравнение $x^3+9x=26$. Тогда $x^3$ можно представить как куб со стороной $x$. Если добавить к нему некий объем равный $9x$ то получится $26$. Представим что мы увеличили сторону куба на $y$, тогда получится куб со стороной $z$. Таким образом что изначальный куб как-бы обложен с разных сторон другими фигурами. Эти фигуры — три параллелепипеда со сторонами $x$, $x$ и $y$, три параллелепипеда поменьше со сторонами $x$, $y$ и $y$ и маленький кубик со стороной $y$. Тарталья соединил все 6 параллелепипедов в один, объём которого равен $3xyz$, что должно быть равно $9x$. Таким образом $3yz=9$. Теперь, если собрать большой куб то остаётся добавить $y^3$ чтобы достроить фигуру. Таким образом $z^3=26+y^3$, получилось два уравнения и два неизвестных, подставив одно уравнение в другое получается $y^6+26y^3=27$. Казалось бы — всё стало ещё хуже, ведь уравнение теперь шестой степени. Но на самом деле если принять за переменную $y^3$ то получится квадратное уравнение которое можно решить методом представленным в главе [Геометрическое решение](#геометрическое-решение). Раз уж $y^3=1$ то отсюда получаем что $y=1$, а исходя из уравнения $3yz=9$ получаем что $z=\frac{3}{y}$, то есть $3$. А так как $x+y=z$, $x$ будет равен $2$. 
Так Тарталья вторым в мире научился решать приведённые кубические уравнения. Он создал алгоритм решения, но записал не в виде формулы, а в виде стихотворения. После победы Тарталья стал настоящей звездой математики. Многие пытались разузнать секрет решения кубических уравнений, но самым упорным из них был [Джероламо Кардано](#джероламо-кардано).

### Джероламо Кардано

Тарталья очень не хотел рассказывать о своём методе, но Кардано не сдавался. Он отправлял одно письмо за другим. В результате, под предлогом знакомства с богатым покровителем ему всё-таки удалось заманить Тарталью в город Милан. Там 25 марта 1539 года Тарталья всё-таки рассказал Кардано о своём алгоритме, но тот должен был поклясться что никому не расскажет его, запишет в виде шифра чтобы никто другой не смог о нём узнать. Кардано был очень счастлив и сразу принялся экспериментировать с формулой чтобы получить решение для любого кубического уравнения (не только приведённого). И самое удивительное что ему это удалось.

#### Общая формула

Если в уравнении $ax^3+bx^2+cx+d=0$ сделать $x$ равным $x-\frac{b}{3a}$, то все $x^2$ исчезнут, а коэффициент $a$ станет равным единице и таким образом можно привести уравнение к приведённой форме, а далее решить по методу Тартальи. На этом всё могло и закончится, если бы не одно событие.

#### Кардано разглашает формулу

В 1542 году Кардано гостит у одного математика в Боллонии, зятя того самого Сцепиона Дель Ферро, который первым открыл формулу для корней приведённого кубического уравнения. Увидев её в тетради которую ему показали гостеприимные хозяева, Кардано понимает, что держать формулу в секрете больше нет смысла.

#### Тарталья в ярости

Через три года выходит в свет "ARTIS MAGNÆ" — справочник по математике написанный Кардано.
> „Написан он за пять лет, да прослужит он пять сотен“

Всем 18 вариантам Омара Хайяма посвящены отдельные главы. Учёный отмечает в работе труды Дель Ферро, Фиори и Тартальи. Несмотря на это, Никколо пишет Кардано гневное письмо на тему раскрытия тайны. Тем не менее, "ARTIS MAGNÆ" испытывает связь геометрии и алгебры на прочность и вот как.

### Снова проблема

Кардано столкнулся с кубическими уравнениями, которые нельзя решить обычным способом. Рассмотрим уравнение $x^3=15x+4$. Если идти по алгоритму то получится следующее:

$$\sqrt[3]{2+\sqrt{-121}}+\sqrt[3]{2-\sqrt{-121}}$$

В ответе появились квадратные корни из отрицательных чисел. Кардано обращается за помощью к Тарталье, но тот отвечает что вопрошающий слишком глуп чтобы понять, как воспользоваться формулой, хотя он и сам не знал что делать. Чтобы понять почему так происходит, Кардано возвращается к геометрическому решению проблемы. Пусть у нас есть квадрат со стороной $5$, а площадь его части равна $30$, соответственно нужно добавить квадрат площадью $-5$ чтобы общая площадь была равна $25$. Но вот незадача: какая будет сторона у квадрата площадью $-5$? Кардано в своей работе называет корни из отрицательных чисел занимательными, но бесполезными.

### Проблему решает Бомбелли

Примерно через 10 лет работу Кардано находит итальянский математик Рафаэль Бомбелли. Он понимает, что корни из отрицательных чисел — это новый вид чисел. Бомбелли представляет числа как сумму действительной части и мнимой умноженной на корень из минус единицы. Остаётся возвести в куб, приравнять и сложить. Мнимые части сокращаются оставляя правильный ответ — $4$.

## Математики развивают комплексные числа

В течении следующих 100 лет математика начнёт приобретать вид к которому мы привыкли.

### Француа Виет

<img src='https://upload.wikimedia.org/wikipedia/commons/thumb/6/6a/Francois_Viete.jpeg/274px-Francois_Viete.jpeg' width='133px'/>

В 17 веке Француа Виет представил математическую нотацию, оставив в прошлом словесные описания с картинками.

### Рене Декарт

<img src='https://upload.wikimedia.org/wikipedia/commons/thumb/7/73/Frans_Hals_-_Portret_van_Ren%C3%A9_Descartes.jpg/274px-Frans_Hals_-_Portret_van_Ren%C3%A9_Descartes.jpg' width='133px'/>

За комплексные числа берётся сам Рене Декарт, что прибавляет им популярности.

### Леонард Эйлер

<img src='https://upload.wikimedia.org/wikipedia/commons/thumb/d/d7/Leonhard_Euler.jpg/792px-Leonhard_Euler.jpg' width='133px'/>

Эйлер вводит латинскую букву $i$ как обозначение корня из минус единицы.
Комплексные числа стали называться комплексными.

## Комплексные числа в физике

<img src='https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR67ZF21_z-SRfmQMVbfOR5UQ6tFe77Q8VaIs2UmBxxAW7h9s_gFgRP5zphhx2bww6SQ2mxbuJsRxkGmMZQbAE1sYvXMFPCeBcSGaXA9EA' width='133px'/>

В 1925 году Эрвин Шрёдингер занялся уравнением волновой функции которая бы описывала движение квантовых частиц. В результате появилось одно из важнейший уравнений физики — уравнение Шрёдингера. В нём появилась мнимая единица — из-за этого многим не нравилось уравнение, ведь такие числа были в новинку для физики. Физик Фриман Дайсон писал:
> „Шрёдингер добавил в уравнение квадратный корень из минус единицы и всё встало на свои места. Теперь это была волновая функция, а не функция передачи тепла. К радости Шрёдингера решения его уравнения совпали с расчётными орбитами электронов в атомной модели Бора. Оказалось что уравнение Шрёдингера безошибочно описывает всё, что мы знаем о поведении атомов. Это основа всей химии и практически всей физики. А корень из минус единицы говорит о том, что природа оперирует не действительными, а комплексными числами. Это открытие удивило Шрёдингера не меньше чем остальных.“

# Формулы

В данной главе пойдёт речь о технической части комплексных чисел, а именно комплексном анализе — разделе математики посвященном комплексным числам.

## Общий вид

Итак, как было сказано ранее, извлекая квадратный корень из отрицательного числа мы получаем мнимое число. Если извлечь корень из минус единицы, то получится мнимая единица, которая обозначается латинской буквой $i$. Мнимое число это произведение действительного числа и мнимой единицы. Если к мнимому числу прибавить действительное, то получится **комплексное число**. Комплексное число обозначается латинской буквой $z$ и имеет вид $z=a+bi$, где $a$ вещественная часть, а $b$ мнимая. Например: $2+i$, $3+4i$, $6-i$, $-3+7i$. Множество комплексных чисел обозначается буквой $\mathbb{C}$.

## Комплексная плоскость

Если использовать $a$ в качестве абсциссы, а $b$ — ординаты, то любое комплексное число можно обозначить точкой на комплексной плоскости.

<img src='https://www.mathsisfun.com/algebra/images/complex-plane-z-example.svg' width='133px'/>

## Простые операции

Как и любые другие числа, комплексные числа можно складывать, вычитать, умножать и делить.

### Сложение и вычитание

Складывать и вычитать комплексные числа очень просто: нужно сложить их абсциссы и ординаты. Вот как это можно получить. Рассмотрим два комплексных числа вида $z_1=a+bi$ и $z_2=c+di$. Их суммой будет $(a+bi)+(c+di)$. Если перегруппировать слагаемые, то получится комплексное число $(a+c)+(b+d)i$, что является суммой двух изначальных. С разностью тоже самое, только с противоположным знаком.

### Умножение и деление

А вот умножать и делить комплексные числа уже сложнее. Если перегруппировать слагаемые и  раскрыть скобки, то получится, что произведением двух комплексных чисел $z_1=a+bi$ и $z_2=c+di$ является $(ac-bd)+(ad+bc)i$. Частное этих комплексных чисел можно записать как $\frac{a+bi}{c+di}$. Умножим числитель и знаменатель на $c-di$:

$$\frac{z_1}{z_2}=\frac{(a+bi)(c-di)}{(c+di)(c-di)}$$

Раскроем скобки:

$$\frac{z_1}{z_2}=\frac{ac-adi+bci-i^2bd}{c^2-cdi+cdi+d^2}$$

Немного преобразуем:

$$\frac{z_1}{z_2}=\frac{(ac+bd)+(bc-ad)i}{c^2+d^2}$$

И отделим мнимую часть от действительной:

$$\frac{z_1}{z_2}=\frac{ac+bd}{c^2+d^2}+\frac{bc-ad}{c^2+d^2}i$$

Вот мы и получили формулы для осуществления простых операций с комплексными числами.

### Взятие сопряжённого

Сопряжённым числом для комплексного числа $z$ является такое число $\bar{z}$, что его мнимая часть имеет обратный знак по отношению к мнимой части изначального числа. Например: сопряжённое число к $2+3i$ это $2-3i$. Кстати если перемножить комплексное число с его сопряжённым, то получится сумма квадратов действительной части и мнимой части. А кто-то ещё говорил что формулы суммы квадратов не существует.

$$a^2+b^2=(a+bi)(a-bi)$$

Ещё это можно записать так:

$$\vert z\vert^2=z\bar{z}$$

## Полярная система координат

Для некоторых вычислений которые будут описаны позже удобнее использовать полярные координаты вместо декартовых. В полярных координатах нужно указать два параметра: длину вектора и его угол. В терминах комплексных чисел эти величины называются модулем и аргументом соответственно. Обычно модуль обозначают буквой $r$, а аргумент буквой $\phi$ или $\theta$. В таком случае, комплексное число можно записать как $z=re^{i\phi}$.

<img src='https://study.com/cimages/multimages/16/capture8871102593202978694.png' width='133px'/>

Вот формулы перевода из полярных координат в декартовых и обратно:

$$a=r\cos(\phi)$$

$$b=r\sin(\phi)$$

$$r=\sqrt{a^2+b^2}$$

$$\phi=\text{atan2}(b,a)$$

Где $\text{atan2}$:

$$\text{atan2}(y,x)=\begin{cases}
    \arctan(\frac{y}{x}), & \text{если } x>0\\
    \arctan(\frac{y}{x})+\pi, & \text{если } x<0 \text{ и } y≥0 \\
	\arctan(\frac{y}{x})-\pi, & \text{если } x<0 \text{ и } y<0 \\
	+\frac{\pi}{2}, & \text{если } x=0 \text{ и } y>0 \\
	-\frac{\pi}{2}, & \text{если } x=0 \text{ и } y<0 \\
	\text{неопределено}, & \text{если } x=0 \text{ и } y=0
  \end{cases}$$

Вот интерактивная визуализация:

<iframe title="Desmos" src="https://www.desmos.com/calculator/blsteslwy5?embed" width="90%" height="600px"></iframe>
  
Кстати, если прологарифмировать полярную запись комплексного числа, то получится $\ln(z)=\ln(r)+i\phi$. Это есть определение комплексного логарифма.

## Умножение на i

У мнимой единицы есть интересное свойство: если возводить её в целые степени, то результаты будут повторяться каждые четыре степени.

$$\begin{align*}
i^0=1\\
i^1=i\\
i^2=-1\\
i^3=-i\\
i^4=1\\
i^5=i\\
i^6=-1\\
i^7=-i\\
\end{align*}$$

Это можно представить как поворот по единичной окружности на комплексной плоскости. Это можно записать так:
$i^n=i^{n\text{ mod }4}$.

## Экспонента

### Формула Эйлера

Сейчас мы выведем одну из важнейших формул в комплексном анализе. Итак, возьмём разложение в ряд Тейлора для экспоненты:

$$e^z=\sum_{n=0}^{\infty}\frac{z^n}{n!}=1+z+\frac{z^2}{2!}+\frac{z^3}{3!}+\frac{z^4}{4!}+\frac{z^5}{5!}+...$$

Теперь подставим $z=iy$.

$$e^{iy}=1+iy+\frac{(iy)^2}{2!}+\frac{(iy)^3}{3!}+\frac{(iy)^4}{4!}+\frac{(iy)^5}{5!}+...$$

Преобразуем, использовав свойство $i$:

$$e^{iy}=1+iy-\frac{y}{2!}-\frac{iy^3}{3!}+\frac{y^4}{4!}+\frac{iy^5}{5!}+...$$

Ну и перегруппируем слагаемые:

$$e^{iy}=\left(1-\frac{y}{2!}+\frac{y^4}{4!}-...\right)+i(y-\frac{y^3}{3!}+\frac{y^5}{5!}-...)$$

И тут становится видно что действительной частью является $\cos(y)$, а мнимой частью является $\sin(y)$, так как это их разложения в ряд Тейлора. Получаем:

$$e^{iy}=\cos(y)+i\sin(y)$$

Получилась формула, которая называется формулой Эйлера. Но это ещё не всё, подставим $y=\pi$ и добавим 1 к обоим частям формулы. Получается, что

$$e^{i\pi}+1=0$$

Эта формула известна как самая красивая формула в математике, ведь она содержит пять известных математических констант из разных областей математики. Иногда её называют тождеством Эйлера.

### Поворот

$e^{i\phi}$ можно представить как поворот на комплексной плоскости. А именно, поворот точки, описывающей число 1 вокруг начала координат на $\phi$ радиан. Например: $e^{i\frac{\pi}2}=i$, потому, что $\frac{\pi}{2}$ радиан это 90 градусов, а при повороте единичного вектора на 90 градусов, мы оказываемся в точке $i$.

## Синус и косинус

Экспонента это конечно хорошо, но есть ведь ещё тригонометрические функции которые тоже нужно определить на комплексной плоскости. Итак, косинус определяется вот так:

$$\cos(z)=\frac{e^{iz}+e^{-iz}}{2}$$

А синус так:

$$\sin(z)=\frac{e^{iz}-e^{-iz}}{2i}$$

Два этих определения очень похожи, и это объясняется формулой Эйлера, о которой шла речь ранее. Если подставить в неё наши определения, то получится:

$$e^{iz}=\frac{e^{iz}+e^{-iz}}{2}+i\frac{e^{iz}-e^{-iz}}{2i}$$

На мнимую единицу можно сократить:

$$e^{iz}=\frac{e^{iz}+e^{-iz}}{2}+\frac{e^{iz}-e^{-iz}}{2}$$

Складываем:

$$e^{iz}=\frac{e^{iz}+e^{-iz}+e^{iz}-e^{-iz}}{2}$$

Приводим подобные слагаемые:

$$e^{iz}=\frac{2e^{iz}}{2}$$

И сокращаем на 2:

$$e^{iz}=e^{iz}$$

Получилось верное равенство, что означает что определения синуса и косинуса верны. Таким образом, можно получить представление для любой другой тригонометрической функции, используя формулы которые их связывают. Из них можно отметить формулу для гиперболических функций. Если в формулу для гиперболического косинуса подставить $iy$, то получится:

$$\cosh(iy)=\frac{e^{iy}+e^{-iy}}{2}$$

что является косинусом прямо по определению. То есть, формула выглядит так:

$$\cosh(iz)=\cos(z)$$

Теперь сделаем тоже самое с гиперболическим синусом:

$$\sinh(iy)=\frac{e^{iy}-e^{-iy}}{2}$$

А теперь умножим числитель и знаменатель на $i$.

$$\sinh(iy)=i\frac{e^{iy}-e^{-iy}}{2i}$$

И вот появился синус!

$$\sinh(iz)=i\sin(z)$$

Вот так мы и вывели формулы для тригонометрических функций.

### Тригонометрические уравнения

Используя мощь комплексных чисел можно вывести формулу для решения любого тригонометрического уравнения вида $\cos(z)=a$. Формула была выведена автором статьи самостоятельно.
Для начала, подставим комплексное определение косинуса в уравнение:

$$\frac{e^{iz}+e^{-iz}}{2}=a$$

Умножим обе части на два:

$$e^{iz}+e^{-iz}=2a$$

Преобразуем, используя свойство степени:

$$e^{iz}+\frac{1}{e^{iz}}=2a$$

Приведём к общему знаменателю:

$$\frac{(e^{iz})^2+1}{e^{iz}}=2a$$

Поменяем местами $e^{iz}$ и $2a$:

$$\frac{(e^{iz})^2+1}{2a}=e^{iz}$$

Разделим дроби обратно:

$$\frac{(e^{iz})^2}{2a}+\frac{1}{2a}=e^{iz}$$

Вычтем $e^{iz}$ из обоих частей:

$$\frac{(e^{iz})^2}{2a}-e^{iz}+\frac{1}{2a}=0$$

Получилось квадратное уравнение относительно $e^{iz}$. Подставим коэффициенты в формулу для корней:

$$e^{iz}=\frac{1\pm\sqrt{1-4\frac{1}{2a}\frac{1}{2a}}}{\frac{2}{2a}}$$

Упростим:

$$e^{iz}=a\left(1\pm\sqrt{1-\frac{1}{a^2}}\right)$$

Раскроем скобки:

$$e^{iz}=a\pm a\sqrt{1-\frac{1}{a^2}}$$

Внесём $a$ внутрь корня:

$$e^{iz}=a\pm \sqrt{a^2(1-\frac{1}{a^2})}$$

Раскроем скобки:

$$e^{iz}=a\pm \sqrt{a^2-1}$$

А теперь решим получившееся уравнение уже относительно $z$. Прологарифмируем обе части:

$$iz=\ln(a\pm \sqrt{a^2-1})$$

И поделим на мнимую единицу:

$$z=-i\ln(a\pm \sqrt{a^2-1})$$

Осталось лишь добавить $2\pi k$, ведь косинус — функция периодическая.

$$z=2\pi k-i\ln(a\pm \sqrt{a^2-1})$$

где $k$ любое целое число.
Нужно подметить, что логарифм тут комплексный, так как аргумент его является комплексным числом. Можно также сказать, что вся формула это просто определение комплексного арккосинуса.

## Возведение в степень

Возводить комплексные числа в степень намного удобнее в полярных координатах, чем в декартовых. Возьмём комплексное число и возведём его в степень:

$$z^n=(re^{i\phi})^n$$

Преобразуем используя свойства степени:

$$z^n=r^ne^{in\phi}$$

Получилось комплексное число, у которого модуль возведён в степень $n$, а аргумент умножен на $n$. Так вот просто.
